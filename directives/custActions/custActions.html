<div ng-show="AgentInfo.EnterTransactionFlag=='Y' || AgentInfo.ChangeCreditLimitFlag=='Y' || AgentInfo.ChangeTempCreditFlag =='Y' || AgentInfo.SuspendWageringFlag=='Y' || AgentInfo.UpdateCommentsFlag=='Y' || AgentInfo.ChangeWagerLimitFlag=='Y' || AgentInfo.AddNewAccountFlag=='Y' || AgentInfo.AddFreePlaysFlag == 'Y'">

  <div class="form-inline">
    <div class="form-group">
      <input type="button" class="btn btn-default mt-4" value="{{Translate('New Transaction')}}" data-target="#insertTranModal" data-toggle="modal">
      <label ng-if="freePlayMode != true" for="PeriodsInput" class="w-100 mt-4">{{Translate('Transaction Type')}}</label>
      <select ng-if="freePlayMode != true" ng-model="Filters.tranType" style="width: 150px;" ng-change="getCustomerTransaction()">
        <option value="all">{{Translate('All')}}</option>
        <option value="wagers">{{Translate('Wagers')}}</option>
        <option value="cash">{{Translate('Cash')}}</option>
        <option value="free">{{Translate('Free Play')}}</option>
      </select>
    </div>
  </div>

  <div class="form-inline">
    <div class="form-group mr-4">
        <label for="startDateInput" class="mt-4 mr-3">{{Translate('Transaction Start Date')}}</label>
      <div class="date-picker">
        <input id="startDateInput" type="text" class="form-control form-control-ios-fix" ng-model="Filters.startDate" name="filterDate" />
      </div>
    </div>
    <div class="form-group">
        <label for="endDateInput" class="mt-4 mr-3">{{Translate('Transaction End Date')}}</label>
      <div class="date-picker">
        <input id="endDateInput" type="text" class="form-control form-control-ios-fix" ng-model="Filters.endDate" name="filterDate" />
      </div>
    </div>
  </div>

  <h3 ng-if="!Report.AllTransactions" class="text-center" ng-bind="Translate('There are no transactions')"></h3>

  <div class="mt-5">
    <div class="ticket" ng-if="Report.AllTransactions.length > 0 && !IsMobile">
      <div class="row">
        <div class="col-xs-12 report-detail-open-bets col-print-12">
          <div class="row graded-header">
            <div class="col-xs-12 col-lg-12 col-xl-12 col-print-12-print hidden-xs hidden-xs">
              <div class="row">
                <div class="col-xs-1">
                  <h2 ng-bind="Translate('ID')"></h2>
                </div>
                <div class="col-xs-1">
                  <h2 ng-bind="Translate('Date')"></h2>
                </div>
                <div class="col-xs-2">
                  <h2 ng-bind="Translate('type')"></h2>
                </div>
                <div class="col-xs-1">
                  <h2 ng-bind="Translate('Credit/Debit')"></h2>
                </div>
                <!--<div class="col-lg-1 col-xl-1 text-right">
                 <h2 ng-bind="Translate('Debit')"></h2>
                </div>-->
                <div class="col-xs-1" ng-if="Filters.tranType != 'free'">
                  <h2 ng-bind="Translate('Balance')"></h2>
                </div>
                <div class="col-xs-4" ng-show="Filters.tranType == 'all' || Filters.tranType == 'wagers'">
                  <h2 ng-bind="Translate('Wager Details')"></h2>
                </div>
                <div class="col-xs-1">
                  <h2 ng-bind="Translate('Entered By')"></h2>
                </div>
                <div class="col-xs-1 text-right">
                  <h2 ng-bind="Translate('Action')"></h2>
                </div>
              </div>
            </div>
          </div>
          <div class="row graded-data" ng-repeat="t in Report.AllTransactions | orderBy:'-DocumentNumber'">
            <div class="col-xs-12 col-lg-12 col-xl-12 col-print-12-print">
              <div class="row">

                <div class="col-xs-1" ng-if="!t.WagerNumber" ng-bind="t.DocumentNumber"></div>
                <div class="col-xs-1" ng-if="t.WagerNumber" ng-bind="t.DocumentNumber + '-' + t.WagerNumber"></div>

                <div class="col-xs-1 col-print-1">
                  <span ng-bind="FormatDateTime(t.TranDateTimeString,16)"></span>
                  <span ng-bind="FormatDateTime(t.TranDateTimeString,8)"></span>
                </div>

                <div class="col-xs-2 col-print-1">
                  <span ng-if="t.WagerNumber" ng-bind="Translate(WagerType(t))"></span>
                  <span ng-if="!t.WagerNumber" ng-bind="getSubDescription(t)"></span>
                </div>

                <div class="col-xs-1 col-print-1">
                  <span ng-show="t.TranCode == 'C'" ng-bind="'+ ' + (t.Amount | formatNumber)"></span><span ng-show="t.TranCode == 'D'" ng-bind="'- ' + (t.Amount | formatNumber)"></span>
                </div>
                <!--<div class="col-lg-1 col-xl-1 text-right col-print-1">
                 <span ng-show="t.TranCode == 'D'" ng-bind="t.Amount | dollar"></span>
                </div>-->
                <div class="col-xs-1 col-print-1" ng-if="Filters.tranType != 'free'">
                  <span ng-bind="t.CurrentBalance | dollar"></span>
                </div>
                <div class="col-xs-4" ng-show="Filters.tranType == 'all' || Filters.tranType == 'wagers'">
                  <button ng-if="t.WagerNumber" role="button" data-toggle="collapse" href="#alltrans_{{$index}}" aria-expanded="false" aria-controls="collapseExample" class="btn btn-xsall btn-graded" ng-bind="Translate('View Graded Results')" ng-show="!(t.TranType == 'X')"></button>

                  <section ng-if="!(t.TranType == 'X')">
                    <div class="collapse" id="alltrans_{{$index}}">
                      <div ng-repeat="ti in t.Items">
                        <div class="graded-data-detail">
                          <a class="icon_viewresults" onclick="changeIcon(this)" role="button" data-toggle="collapse" href="" data-target="#resultsf_{{$parent.$index}}_{{$index}}" aria-expanded="false" aria-controls="collapseExample"></a>
                          <strong ng-class="{num_neg: ti.Result == 'LOST', num_pos: ti.Result == 'WON'}" ng-bind="Translate(ti.Result) + ' '"></strong><span ng-bind="ti.Description"></span>
                          <div class="collapse" id="resultsf_{{$parent.$index}}_{{$index}}" ng-show="ti.Outcome != 'P'">
                            <b ng-bind="Translate('Game Results')+':'"></b>
                            <span ng-bind="ScoredPtsHeader(ti)"></span>
                            <br />
                            <span ng-bind="WriteTeamsScores(ti)"></span>
                            <br />
                            <span ng-bind="WriteWinner(ti)"></span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </section>
                  <section ng-bind="t.Description || t.ShortDesc" ng-if="t.TranType == 'X'">
                  </section>
                  <section ng-bind="getSubDescription(t, 1)" ng-if="t.IsTransaction"></section>
                </div>
                <div class="col-xs-1">
                  <section ng-bind="t.EnteredBy"></section>
                </div>
                <div class="col-xs-1 text-right no-printable">
                  <button ng-bind="Translate('Delete')" ng-click="DeleteTransaction(t.DocumentNumber)" ng-if="AgentInfo.EnterTransactionFlag == 'Y' && transactionIsThisWeek(t) && !(t.TranType == 'A' || t.TranType == 'L' || t.TranType == 'W' || t.TranType == 'R' || t.TranType == 'X')"></button>
                </div>
              </div>
            </div>
          </div>
          <!-- /.graded-data -->
        </div>
      </div>
    </div>

    <div class="row bg-white px-4" ng-if="Report.AllTransactions.length > 0 && IsMobile">
      <div class="ticket">
        <div class="row">
          <div class="col-sm-12 report-detail-open-bets col-print-12">
            <div class="row graded-data" ng-repeat="t in Report.AllTransactions | orderBy:'-DocumentNumber'">
              <div class="col-xs-12-force">

                <div class="row">
                  <div class="col-xs-12">
                    <div>

                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-12 d-flex" style="justify-content: space-between;display: flex">
                    <div class="sm-tik-title">
                      <br class="visible-print">
                      <span ng-bind="Translate('ID') + ': '"></span>
                      <span ng-bind="t.DocumentNumber + '-' + t.WagerNumber"></span>
                    </div>
                    <div>
                      <span ng-bind="FormatDateTime(t.TranDateTimeString,16)"></span>&nbsp;<span ng-bind="FormatDateTime(t.TranDateTimeString, 8)"></span>
                    </div>
                  </div>

                </div>

                <div class="row">
                  <div class="col-xs-10 text-center openBetTotal my-1">
                    <br class="visible-print"><span ng-bind="Translate('Credt/Debit') + ' '"> </span>
                    <fplabel ng-show="oB.FreePlayFlag == 'Y'"> ({{Translate("FP")}})</fplabel>
                    <span ng-show="t.TranCode == 'C'" ng-bind="'+ ' + (t.Amount | formatNumber)"></span><span ng-show="t.TranCode == 'D'" ng-bind="'- ' + (t.Amount | formatNumber)"></span>
                    &nbsp;/&nbsp;
                    <br class="visible-print"><span ng-bind="Translate('Balance'+ ' ')"></span>
                    <span ng-bind="t.CurrentBalance | formatNumber"></span>
                  </div>
                  <div class="col-xs-2 text-center openBetTotal justify-content-center my-1">
                    <button ng-if="AgentInfo.EnterTransactionFlag == 'Y' && transactionIsThisWeek(t)" class="btn btn-default" ng-click="DeleteTransaction(t.DocumentNumber)" ng-bind="Translate('delete')"></button>
                  </div>
                  <div class="col-xs-12 my-1">
                    <span ng-if="t.WagerNumber" ng-bind="Translate('Description:') + ' ' + Translate(WagerType(t))"></span>
                    <span ng-if="!t.WagerNumber" ng-bind="Translate('Description:') + ' ' + t.ShortDesc"></span>
                  </div>
                  <div class="col-xs-12 my-1" ng-show="Filters.tranType == 'all' || Filters.tranType == 'wagers'">
                    <div class="d-flex justify-content-center w-100">
                      <button ng-if="t.WagerNumber" role="button" data-toggle="collapse" href="#alltrans_{{$index}}" aria-expanded="false" aria-controls="collapseExample" class="btn btn-xsall btn-graded" ng-bind="Translate('View Graded Results')" ng-show="!(t.TranType == 'X')"></button>
                    </div>
                    <section ng-if="!(t.TranType == 'X')">
                      <div class="collapse" id="alltrans_{{$index}}">
                        <div ng-repeat="ti in t.Items">
                          <div class="graded-data-detail">
                            <a class="icon_viewresults" onclick="changeIcon(this)" role="button" data-toggle="collapse" href="" data-target="#resultsf_{{$parent.$index}}_{{$index}}" aria-expanded="false" aria-controls="collapseExample"></a>
                            <strong ng-class="{num_neg: ti.Result == 'LOST', num_pos: ti.Result == 'WON'}" ng-bind="Translate(ti.Result) + ' '"></strong><span ng-bind="ti.Description"></span>
                            <div class="collapse" id="resultsf_{{$parent.$index}}_{{$index}}" ng-show="ti.Outcome != 'P'">
                              <b ng-bind="Translate('Game Results')+':'"></b>
                              <span ng-bind="ScoredPtsHeader(ti)"></span>
                              <br />
                              <span ng-bind="WriteTeamsScores(ti)"></span>
                              <br />
                              <span ng-bind="WriteWinner(ti)"></span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </section>
                    <section ng-bind="t.Description || t.ShortDesc" ng-if="t.TranType == 'X'">
                    </section>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="insertTranModal">
  <div class="modal-dialog">

    <div class="modal-content">

      <div class="modal-header">
        <button type="button"  class="close" data-dismiss="modal">&times;</button>
        <h1 class="modal-title" ng-bind="Translate('New Transaction')"></h1>
      </div>
      <div class="modal-body mb-3">
        <div class="d-flex">
          <label for="PeriodsInput" class="mt-4 mr-3">{{Translate('Transaction Type:')}}</label>
          <select ng-model="tranInfo.tranType" style="width: 150px; height: 25px" class="mr-4 mt-4">
            <option value="Deposit" ng-if="freePlayMode != true && AgentInfo.EnterTransactionFlag=='Y'">{{Translate('Deposit')}}</option>
            <option value="Withdrawal" ng-if="freePlayMode != true && AgentInfo.EnterTransactionFlag=='Y'">{{Translate('Withdrawal')}}</option>
            <option value="FpDeposit" ng-if="AgentInfo.AddFreePlaysFlag == 'Y'">{{Translate('Free Plays Deposit')}}</option>
            <option value="FpWithdrawal" ng-if="AgentInfo.AddFreePlaysFlag == 'Y'">{{Translate('Free Plays Withdrawal')}}</option>
            <option value="BetAdjCredit" ng-if="freePlayMode != true && AgentInfo.EnterBettingAdjustmentFlag == 'Y'">{{Translate('Bet Adj Credit')}}</option>
            <option value="BetAdjDebit" ng-if="freePlayMode != true && AgentInfo.EnterBettingAdjustmentFlag == 'Y'">{{Translate('Bet Adj Debit')}}</option>
            <option value="PromotionalCredit" ng-if="freePlayMode != true && AgentInfo.EnterBettingAdjustmentFlag == 'Y'">{{Translate('Promotional Credit')}}</option>
            <option value="PromotionalDebit" ng-if="freePlayMode != true && AgentInfo.EnterBettingAdjustmentFlag == 'Y'">{{Translate('Promotional Debit')}}</option>
          </select>
          <div class="d-flex" ng-if="!IsMobile && !customer.IsAgent && AgentInfo.EnterBettingAdjustmentFlag=='Y' && AgentInfo.ChangeTempCreditFlag == 'Y' && (tranInfo.tranType == 'BetAdjDebit' || tranInfo.tranType == 'BetAdjCredit')">
            <label class="mt-4 mr-3" for="tranDateInput">{{Translate('Transaction Date:')}}</label>
            <input id="tranDateInput" type="text" class="form-control w-lg-50 mt-4" ng-model="Filters.tranDate">
            <!--<select class="form-control ml-5" ng-model="dateSelection.dailyFigure"
            ng-options="dR.DayOfWeekStr for dR in DatesRange"></select>-->
          </div>
        </div>
        <div class="d-flex" ng-if="IsMobile && !customer.IsAgent && AgentInfo.EnterBettingAdjustmentFlag=='Y' && AgentInfo.ChangeTempCreditFlag == 'Y' && (tranInfo.tranType == 'BetAdjDebit' || tranInfo.tranType == 'BetAdjCredit')">
          <label class="mt-4 mr-3" for="tranDateInput">{{Translate('Transaction Date:')}}</label>
          <input id="tranDateInput" type="text" class="form-control w-lg-50 mt-4" ng-model="Filters.tranDate" style="width: 100px">
        </div>
        <label class="w-100 mt-4" for="txtPaymentAmt">{{Translate('Amount:')}}</label>
        <input type="number" class="form-control form-control-ios-fix w-lg-50" ng-model="tranInfo.paymentAmt"
               id="txtPaymentAmt" ng-disabled="((tranInfo.tranType == 'BetAdjDebit' || tranInfo.tranType == 'BetAdjCredit') && AgentInfo.EnterBettingAdjustmentFlag!='Y') 
               || ((tranInfo.tranType == 'Withdrawal' || tranInfo.tranType == 'Deposit') && AgentInfo.EnterTransactionFlag!='Y') 
               || ((tranInfo.tranType == 'PromotionalCredit' || tranInfo.tranType == 'PromotionalDebit') && AgentInfo.EnterTransactionFlag!='Y') 
               || ((tranInfo.tranType == 'FpDeposit' || tranInfo.tranType == 'FpWithdrawal') && AgentInfo.AddFreePlaysFlag!='Y') || IsDisabled()">
        <label for="txtPaymentAmt" class="mt-4">{{Translate('Description:')}}</label>
        <textarea id="txtADescription" class="form-control w-lg-50" ng-model="tranInfo.paymentDescr" ng-disabled="IsDisabled()"></textarea>
        <label class="w-100 mt-4" ng-bind="Translate('Current balance: ')"></label><span ng-bind="($parent.SelectedCustomer.CurrentBalance + ($parent.SelectedCustomer.CasinoBalance || 0)) | formatNumber"></span>
        <label class="w-100 mt-4" ng-bind="Translate('Freeplay balance: ')"></label><span ng-bind="customer.FreePlayBalance | formatNumber"></span>
      </div>

      <div class="modal-footer d-flex justify-content-center">
        <button class="btn btn-success" ng-click="PostPaymentTransaction()">{{Translate('Submit')}}</button>
      </div>
    </div>

  </div>
</div>